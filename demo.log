/Users/tangyao/miniconda3/lib/python3.13/site-packages/torch/amp/autocast_mode.py:270: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling
  warnings.warn(
Failed to import atk_pdm_protect_image: attempted relative import with no known parent package

============================================================
FlowEdit保护性噪声演示
============================================================

加载图像: modules/FlowEdit/example_images/gas_station.png
图像大小: torch.Size([1, 3, 1024, 1024])
图像值域: [0.0000, 1.0000]

============================================================
演示1: 频域对抗噪声 (Frequency Domain Adversarial Noise)
============================================================
生成频域对抗噪声...
图像相似度指标:
  PSNR: 61.85 dB
  SSIM: 0.9996
  L∞距离: 0.003966
  L2距离: 1.421824
图像已保存到: outputs/01_original.png
图像已保存到: outputs/01_freq_noise.png

============================================================
演示2: 多尺度纹理对抗噪声 (Multi-Scale Texture Noise)
============================================================
生成多尺度纹理对抗噪声...
图像相似度指标:
  PSNR: 35.76 dB
  SSIM: 0.9949
  L∞距离: 0.033764
  L2距离: 28.903316
图像已保存到: outputs/02_texture_noise.png

============================================================
演示3: 综合保护性噪声 (Combined Protective Noise)
============================================================
生成综合保护性噪声...
图像相似度指标:
  PSNR: 44.09 dB
  SSIM: 0.9989
  L∞距离: 0.016901
  L2距离: 11.074305
图像已保存到: outputs/03_combined_noise.png

============================================================
演示4: 损失函数配置
============================================================
损失函数配置:
  EditQualityLoss: 启用=True, 权重=0.6
  ImperceptibilityLoss: 启用=True, 权重=0.2
  RobustnessLoss: 启用=True, 权重=0.15
  FeatureAdversarialLoss: 启用=True, 权重=0.4
  FrequencyAdversarialLoss: 启用=True, 权重=0.25

综合损失函数已创建
所有损失函数都可通过LossConfig灵活启用/禁用

============================================================
演示总结
============================================================

各种噪声方法的性能对比:
方法                   PSNR       SSIM       L∞           L2          
----------------------------------------------------------------
frequency            61.85      0.9996     0.003966     1.421824    
texture              35.76      0.9949     0.033764     28.903316   
combined             44.09      0.9989     0.016901     11.074305   

============================================================
演示完成！
输出文件已保存到: outputs
============================================================
